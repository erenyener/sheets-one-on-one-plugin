<!DOCTYPE html>
<html>
    <head>
        <base target="_top">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
        <style>
            .hide {
                display: none !important;
            }
            .active {
                display: block !important;
            }

            .row.footer {
                position: absolute;
                bottom: 0;
                width: 100%;
            }
        </style>
    </head>
    <body>
        <div class="container-fluid">

            <div id="section1" data-id="1" class="row active">
                <div class="col">
                    <div class="mb-3">
                        <label for="cycleTime" class="form-label">What is your cycle time in days for 1-1s ?</label>
                        <input type="text" data-validations="required,number" data-settings-key="cycletime" class="form-control" id="cycleTime" placeholder="60">
                    </div>
                </div>
            </div>

            <div id="section2" data-id="2" style="display: none;" class="row">
                <div class="col">
                    <div class="mb-3">
                        <label for="customField" class="form-label">What are your custom fieds ?</label>
                        <input type="text" class="form-control" id="customField" placeholder="Team">
                    </div>
                </div>
            </div>

            <div id="section3" data-id="3" style="display: none;" class="row">
                <div class="col">
                    <div class="mb-3">
                        <label for="customField" class="form-label">Import your data as CSV ?</label>
                        <input type="text" class="form-control" id="customField" placeholder="Team">
                    </div>
                </div>
            </div>

            <div class="row footer">
                <div class="col">
                    <button id="prev" type="button" style="display: none;" class="btn btn-warning float-start">Prev</button>
                </div>
                <div class="col ">
                    <button id="next" type="button" class="btn btn-success float-end">Next</button>
                </div>
            </div>
        </div>
    </body>
    <script src="https://code.jquery.com/jquery-3.6.1.min.js" crossorigin="anonymous"></script>
    <script>
        
        $(document).ready(function() {
            

            function validateSection(activeSectionId) {

                let validationResult = [];
                const $activeSection = $('#section' + activeSectionId);

                const inputs = $activeSection.find('input');

                inputs.each((index, $input) => {
                    const validations = $($input).attr('data-validations').split(',');
                    const value = $($input).val();
                    validations.forEach((validationRule) => {
                        
                        if(validationRule == "required" && !value) {
                            validationResult.push( { rule: validationRule, input: $input, inputIndex : index, message: "Missing required input" })
                        }

                        if(validationRule == "number" && isNaN(parseInt(value))) {
                            validationResult.push( { rule: validationRule, input: $input, inputIndex : index, message: "Input is not number" })
                        }
                    })
                })

                return validationResult;
                
            }

            setTimeout(() => {
                console.log(validateSection(1))
            }, 5000)
            

            $("#next").on( "click", () => {

                const activeSectionId = parseInt($('.active').attr("data-id"));
                const nextSectionId = activeSectionId + 1;
                const isFinalSection = $('#section' + (nextSectionId + 1)).length === 0;

                const validationResult = validateSection(activeSectionId);

                if(validationResult && validationResult.length > 0) {
                    alert(validationResult[0].message)
                    return false;
                }

                if(isFinalSection) {
                    $('#next').hide();
                }
                else {
                    $('#prev').show();
                }

                $('#section' + activeSectionId).hide();
                $('#section' + activeSectionId).removeClass('active');
                $('#section' + nextSectionId).show();
                $('#section' + nextSectionId).addClass('active');
            });

            $('#prev').on( "click", () => {
                const activeSectionId = parseInt($('.active').attr("data-id"));
                const prevSectionId = activeSectionId - 1;
                const isFirstSession = prevSectionId === 1;

                if(isFirstSession) {
                    $('#prev').hide();
                }
                else {
                    $('#next').show();
                }

                $('#section' + activeSectionId).hide();
                $('#section' + activeSectionId).removeClass('active');
                $('#section' + prevSectionId).show();
                $('#section' + prevSectionId).addClass('active');

            })
        });
    </script>
</html>


